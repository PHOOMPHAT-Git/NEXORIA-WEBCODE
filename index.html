<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>NEXORIA</title>
  <link rel="icon" type="image/png" href="./img/BIG_LOGO.png"/>
  <link rel="stylesheet" href="./css/home.css">
</head>
<body>
  <nav class="top-nav">
    <div class="nav-logo">
      <img src="./img/NEXORIA_WHITE_LOGO.png" alt="NEXORIA logo">
    </div>
  
    <div class="hamburger" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
  
    <div class="nav-center" id="mobileMenu">
      <a href="/setting">SETTINGS</a>
    </div>
  </nav>

  <section class="nx-partners fade-slide-up" aria-label="Sponsors & Partners">
    <div class="nx-partners__edge nx-partners__edge--left"></div>
    <div class="nx-partners__edge nx-partners__edge--right"></div>
    <div class="nx-partners__scroller" id="partnersScroller">
      <div class="nx-partners__track" id="partnersTrack">
        <div class="nx-partners__group">
          <a class="nx-partner" href="" target="_blank" rel="noopener">Empty</a>
        </div>
      </div>
    </div>
  </section>

  <div class="content">
    <h1 class="fade-slide-up">NEXORIA</h1>
    <h3 class="fade-slide-up"
      data-en="Welcome to our website."
      data-th="ยินดีต้อนรับสู่เว็บไซต์ของเรา">
      Welcome to our website.
    </h3>

  </div>

  <section class="nx-banner fade-slide-up" style="--bg:url('/img/PHEYA_sit_staring_fixedly.png')">
    <div class="nx-banner__bg"></div>
    <div class="nx-banner__glow nx-banner__glow--left"></div>
    <div class="nx-banner__glow nx-banner__glow--right"></div>

    <div class="nx-banner__inner">
      <div class="nx-banner__text">
        <div class="nx-banner__eyebrow" data-en="ANNOUNCEMENT" data-th="ประกาศ">ANNOUNCEMENT</div>
        <h2 class="nx-banner__title"
            data-en="Release"
            data-th="เปิดเกม">
          Release
        </h2>
        <p class="nx-banner__subtitle"
           data-en="XX XXXXXXXX XXXX"
           data-th="XX XXXXXXXX XXXX">
          XX XXXXXXXX XXXX
        </p>

        <div class="nx-banner__actions">
          <div class="nx-countdown" id="nx-countdown" role="timer" aria-live="polite">
            <div class="nx-countdown__item">
              <span class="nx-countdown__num" id="cd-days">00</span>
              <span class="nx-countdown__label">DAYS</span>
            </div>
            <div class="nx-countdown__sep">:</div>
            <div class="nx-countdown__item">
              <span class="nx-countdown__num" id="cd-hours">00</span>
              <span class="nx-countdown__label">HRS</span>
            </div>
            <div class="nx-countdown__sep">:</div>
            <div class="nx-countdown__item">
              <span class="nx-countdown__num" id="cd-mins">00</span>
              <span class="nx-countdown__label">MIN</span>
            </div>
            <div class="nx-countdown__sep">:</div>
            <div class="nx-countdown__item">
              <span class="nx-countdown__num" id="cd-secs">00</span>
              <span class="nx-countdown__label">SEC</span>
            </div>
          </div>
          <div class="nx-countdown__meta" id="cd-meta"></div>
        </div>
      </div>

      <img src="./img/NEXORIA_GOLD_LOGO.png" alt="NEXORIA emblem" class="nx-banner__art" />
    </div>
  </section>

  <section class="nx-banner-row fade-slide-up">
    <article class="nx-mini-banner nx-mini-banner--stretch">
      <div class="nx-mini-banner__inner">
        <div class="nx-mini-banner__eyebrow" data-en="DEVLOG" data-th="บันทึกพัฒนา">DEVLOG</div>
        <h3 class="nx-mini-banner__title" data-en="New Weapon Showcase" data-th="โชว์อาวุธใหม่">New Weapon Showcase</h3>
        <p class="nx-mini-banner__subtitle"
          data-en="Sneak peek of the new weapon"
          data-th="แอบส่องอาวุธใหม่">Sneak peek of the new weapon</p>
        <a href="/devlog" class="nx-btn nx-btn--ghost">Read</a>
      </div>
    </article>

    <article class="nx-mini-banner nx-mini-banner--stretch" style="--bg:url('/img/PHEYA_hands_on_hips.png')">
      <div class="nx-mini-banner__inner">
        <div class="nx-mini-banner__eyebrow" data-en="COMMUNITY" data-th="ชุมชน">COMMUNITY</div>
        <h3 class="nx-mini-banner__title" data-en="Join Our Discord Server" data-th="เข้าร่วมดิสคอร์ดเซิร์ฟเวอร์">Join Our Discord Server</h3>
        <p class="nx-mini-banner__subtitle"
          data-en="Chat with players, get updates"
          data-th="พูดคุยกับผู้เล่น รับอัปเดต">Chat with players, get updates</p>
        <a id="discordLinkBanner" href="#" target="_blank" class="nx-btn">Join</a>
      </div>
    </article>
  </section>
  
  <footer class="footer fade-slide-up">
    <div class="footer-container">
      <div class="footer-column">
        <h3 data-en="About Us" data-th="เกี่ยวกับเรา">About Us</h3>
        <p 
          data-en="NEXORIA is an MMORPG that focuses on realism with a touch of fantasy. You can freely roam across the map without quests restricting your travel area."
          data-th="NEXORIA คือเกมแนว MMORPG ที่เน้นสมจริงและแฟนตาซีเล็กน้อย คุณสามารถโลดแล่นไปทั่วแผนที่ได้โดยไม่มีเควสที่จำกัดพื้นที่ในการเดินทางของคุณ">
          NEXORIA is an MMORPG that focuses on realism with a touch of fantasy. You can freely roam across the map without quests restricting your travel area.
        </p>
      </div>

      <div class="footer-column">
        <h3 data-en="Social" data-th="โซเซียล">Social</h3>
        <ul>
          <li><a href="https://tiktok.com/@phoomphat_phe" target="_blank">Tiktok</a></li>
        </ul>
      </div>

      <div class="footer-bottom">
        <img src="./img/NEXORIA_GOLD_LOGO.png" alt="NEXORIA Logo">
        <p>© 2025 NEXORIA. All rights reserved.</p>
      </div>
    </div>
  </footer>
  <div class="nx-toast-area" id="nx-toast-area" aria-live="polite" aria-atomic="true"></div>
</body>
<script>
  document.addEventListener("keydown", function (e) {
    if (
      e.key === "F12" || 
      (e.ctrlKey && e.shiftKey && e.key === "I") || 
      (e.ctrlKey && e.key === "U")
    ) {
      e.preventDefault();
      return false;
    }
  });

  document.addEventListener("contextmenu", function (e) {
    e.preventDefault();
  });

  fetch('/config.json')
    .then(response => response.json())
    .then(config => {
      if (config.discord) {
        const discordTop = document.getElementById("discordLinkTop");
        const discordFooter = document.getElementById("discordLinkaFooter");
        const discordBanner = document.getElementById("discordLinkBanner");

        if (discordTop) discordTop.href = config.discord;
        if (discordFooter) discordFooter.href = config.discord;
        if (discordBanner) discordBanner.href = config.discord;
      }
    })
  .catch(err => console.error("Failed to load config.json:", err));

  function toggleCustomDropdown(clickedHeader) {
    const dropdown = clickedHeader.closest(".custom-dropdown");
    const isOpen = dropdown.classList.contains("open");

    document.querySelectorAll(".custom-dropdown").forEach(d => {
        if (d !== dropdown) d.classList.remove("open");
    });

    if (!isOpen) {
        dropdown.classList.add("open");
    } else {
        dropdown.classList.remove("open");
    }
  }

  function selectOption(element) {
    const dropdown = element.closest(".custom-dropdown");
    const header = dropdown.querySelector(".dropdown-header");

    if (!dropdown.dataset.defaultText) {
      dropdown.dataset.defaultText = header.textContent;
    }

    const defaultText = dropdown.dataset.defaultText;

    if (element.classList.contains("selected")) {
      header.textContent = defaultText;
      header.style.color = "#444";
      element.classList.remove("selected");
    } else {
      dropdown.querySelectorAll(".dropdown-options li").forEach(li => {
        li.classList.remove("selected");
      });
      element.classList.add("selected");
      header.textContent = element.textContent;
      header.style.color = "#fff";
    }

    dropdown.classList.remove("open");
  }

  function toggleUnder(element) {
    const allFrames = document.querySelectorAll('.under-frame');
    allFrames.forEach(frame => {
        if (frame !== element && frame.classList.contains('open')) {
            const otherTitle = frame.querySelector('.under-title');
            otherTitle.style.maxHeight = "0";
            otherTitle.style.opacity = 0;
            otherTitle.style.paddingTop = 0;
            otherTitle.style.paddingBottom = 0;
            frame.classList.remove('open');
        }
    });

    const title = element.querySelector('.under-title');
    if (element.classList.contains('open')) {
        title.style.maxHeight = "0";
        title.style.opacity = 0;
        title.style.paddingTop = 0;
        title.style.paddingBottom = 0;
        element.classList.remove('open');
    } else {
        title.style.maxHeight = title.scrollHeight + "px";
        title.style.opacity = 1;
        title.style.paddingTop = "0.5rem";
        title.style.paddingBottom = "0.25rem";
        element.classList.add('open');
    }
  }

  function toggleMenu() {
    const menu = document.getElementById("mobileMenu");
    const hamburger = document.querySelector(".hamburger");
    const isOpen = menu.classList.contains("show");

    if (isOpen) {
      menu.style.maxHeight = "0px";
      menu.style.padding = "0";
      menu.classList.remove("show");
      hamburger.classList.remove("active");
    } else {
      menu.classList.add("show");
      menu.style.maxHeight = menu.scrollHeight + "px";
      menu.style.padding = "3.5rem 0";
      hamburger.classList.add("active");
    }
  }

  async function updateExchangeRate() {
    try {
      const response = await fetch("https://open.er-api.com/v6/latest/USD");
      const data = await response.json();

      console.log("Exchange Rate Data:", data);

      if (data && data.result === "success" && data.rates && data.rates.THB) {
        const rate = data.rates.THB;
        const baht = (1 * rate).toFixed(2);
        document.getElementById("baht-amount").textContent = `${baht} บาท`;
      } else {
        document.getElementById("baht-amount").textContent = "N/A";
        console.error("Invalid rate data format:", data);
      }
    } catch (error) {
      document.getElementById("baht-amount").textContent = "Error fetching rate";
      console.error("Exchange rate fetch error:", error);
    }
  }

  const COUNTDOWN_THAI = "";

  function parseThaiToUTC(dateTimeTH) {
    const m = dateTimeTH.trim().match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})\s+(\d{1,2}):(\d{2})$/);
    if(!m) return null;
    const dd = parseInt(m[1],10);
    const mm = parseInt(m[2],10);
    const yyyy = parseInt(m[3],10);
    const HH = parseInt(m[4],10);
    const MI = parseInt(m[5],10);
    const TH_OFFSET = 7;
    return Date.UTC(yyyy, mm-1, dd, HH - TH_OFFSET, MI, 0, 0);
  }

  function two(n){ return String(n).padStart(2,'0'); }

  function startCountdown(targetUTCms){
    const elD = document.getElementById('cd-days');
    const elH = document.getElementById('cd-hours');
    const elM = document.getElementById('cd-mins');
    const elS = document.getElementById('cd-secs');
    const meta = document.getElementById('cd-meta');

    const targetDateUTC = new Date(targetUTCms);
    const thaiStr = targetDateUTC.toLocaleString('th-TH',{
      timeZone:'Asia/Bangkok', year:'numeric', month:'2-digit', day:'2-digit',
      hour:'2-digit', minute:'2-digit', hour12:false, timeZoneName:'short'
    });
    const localStr = targetDateUTC.toLocaleString(undefined,{
      year:'numeric', month:'2-digit', day:'2-digit',
      hour:'2-digit', minute:'2-digit', hour12:false, timeZoneName:'short'
    });
    meta.textContent = `Bangkok : ${thaiStr} - Your time : ${localStr}`;

    function tick(){
      const diff = targetUTCms - Date.now();
      if (diff <= 0){
        elD.textContent = '00'; elH.textContent = '00';
        elM.textContent = '00'; elS.textContent = '00';
        meta.textContent = 'Release now!';
        clearInterval(_timer);
        return;
      }
      const total = Math.floor(diff/1000);
      const d = Math.floor(total/86400);
      const h = Math.floor((total%86400)/3600);
      const m = Math.floor((total%3600)/60);
      const s = total%60;
      elD.textContent = two(d);
      elH.textContent = two(h);
      elM.textContent = two(m);
      elS.textContent = two(s);
    }
    tick();
    const _timer = setInterval(tick,1000);
  }

  (function initCountdown(){
    const target = parseThaiToUTC(COUNTDOWN_THAI);
    if(target){ startCountdown(target); }
    else{
      const meta = document.getElementById('cd-meta');
      if(meta) meta.textContent = 'Invalid date-time.';
    }
  })();

  (function(){
    const scroller=document.getElementById('partnersScroller');
    const track=document.getElementById('partnersTrack');
    if(!scroller||!track)return;

    const originals=Array.from(track.querySelector('.nx-partners__group')?track.querySelector('.nx-partners__group').children:track.children);
    function makeGroup(){
      const g=document.createElement('div');
      g.className='nx-partners__group';
      originals.forEach(n=>g.appendChild(n.cloneNode(true)));
      return g;
    }
    function build(){
      track.innerHTML='';
      const g1=makeGroup();
      track.appendChild(g1);
      const singleW=g1.getBoundingClientRect().width;
      let need=scroller.clientWidth+singleW*2;
      let total=singleW;
      while(total<need){const g=makeGroup();track.appendChild(g);total+=singleW}
      return {singleW,ref:g1};
    }

    let {singleW}=build();
    let x=0,run=true,v=70,last=performance.now();
    function step(t){
      const dt=(t-last)/1000;last=t;
      if(run){x+=v*dt;while(x>=singleW)x-=singleW}
      track.style.transform=`translate3d(${-x}px,0,0)`;
      requestAnimationFrame(step);
    }
    requestAnimationFrame(step);

    let dragging=false, moved=false, prev=0;

    scroller.addEventListener('pointerdown',e=>{
      if(e.button!==0) return;
      if(e.target.closest('a')) return;
      dragging=true; run=false; moved=false;
      prev=e.clientX;
      scroller.setPointerCapture(e.pointerId);
    });

    scroller.addEventListener('pointermove',e=>{
      if(!dragging) return;
      const dx=e.clientX-prev; prev=e.clientX;
      if(Math.abs(dx)>3) moved=true;
      x-=dx; while(x<0)x+=singleW; while(x>=singleW)x-=singleW;
      track.style.transform=`translate3d(${-x}px,0,0)`;
    });

    function end(e){
      if(!dragging) return;
      dragging=false;
      if(moved){ scroller.addEventListener('click', blockOnce, {capture:true, once:true}); }
      moved=false; run=true;
      if(e && e.pointerId!=null) try{ scroller.releasePointerCapture(e.pointerId); }catch{}
    }
    function blockOnce(ev){
      if(ev.target.closest('a')){ ev.preventDefault(); ev.stopPropagation(); }
    }

    scroller.addEventListener('pointerup',end);
    scroller.addEventListener('pointercancel',end);
    scroller.addEventListener('pointerleave',end);

    let wt=null;
    scroller.addEventListener('wheel',e=>{
      e.preventDefault();
      const d=Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.deltaX:e.deltaY;
      x+=d; while(x<0)x+=singleW; while(x>=singleW)x-=singleW;
      track.style.transform=`translate3d(${-x}px,0,0)`;
      run=false; clearTimeout(wt); wt=setTimeout(()=>run=true,800);
    },{passive:false});

    let rt;
    window.addEventListener('resize',()=>{
      clearTimeout(rt);
      rt=setTimeout(()=>{singleW=build().singleW;x%=singleW},120);
    });

    if(window.matchMedia('(prefers-reduced-motion: reduce)').matches){v=0}
  })();

  (() => {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    function burst(x,y){
      const count=10;
      for(let i=0;i<count;i++){
        const s=document.createElement('i');
        s.className='nx-shard';
        const ang=(i/count)*Math.PI*2+(Math.random()*0.5-0.25);
        const dist=50+Math.random()*80;
        const sz=4+Math.random()*3;
        const rot=(Math.random()*360-180)+'deg';
        const dur=(360+Math.random()*240)+'ms';
        s.style.setProperty('--x', x+'px');
        s.style.setProperty('--y', y+'px');
        s.style.setProperty('--dx', Math.cos(ang)*dist+'px');
        s.style.setProperty('--dy', Math.sin(ang)*dist+'px');
        s.style.setProperty('--sz', sz+'px');
        s.style.setProperty('--rot', rot);
        s.style.setProperty('--dur', dur);
        document.body.appendChild(s);
        s.addEventListener('animationend', ()=>s.remove(), {once:true});
      }
    }

    function isPrimaryTrigger(e){
      if('pointerType' in e){
        if(e.pointerType==='mouse') return e.button===0;
        return e.isPrimary!==false;
      }
      if(e.type==='mousedown') return e.button===0;
      if(e.type==='touchstart') return true;
      return true;
    }

    function getXY(e){
      if(e.touches && e.touches[0]) return {x:e.touches[0].clientX, y:e.touches[0].clientY};
      return {x:e.clientX, y:e.clientY};
    }

    function trigger(e){
      if(!isPrimaryTrigger(e)) return;
      const p=getXY(e);
      if(!p) return;
      burst(p.x,p.y);
    }

    if('onpointerdown' in window){
      window.addEventListener('pointerdown', trigger, {capture:true, passive:true});
    }else{
      window.addEventListener('mousedown', trigger, {capture:true, passive:true});
      window.addEventListener('touchstart', trigger, {capture:true, passive:true});
    }
  })();

  (function(){
    function showToast(message, timeout){
      const area = document.getElementById('nx-toast-area');
      if(!area) return;
      const toast = document.createElement('div');
      toast.className = 'nx-toast';
      toast.setAttribute('role','alert');
      const bar = document.createElement('span');
      bar.className = 'nx-toast__bar';
      const text = document.createElement('div');
      text.className = 'nx-toast__text';
      text.textContent = message || 'ปุ่มถูกล็อก';
      toast.appendChild(bar);
      toast.appendChild(text);
      area.appendChild(toast);

      let hideTimer = setTimeout(close, timeout ?? 2400);
      toast.addEventListener('mouseenter', () => { clearTimeout(hideTimer); });
      toast.addEventListener('mouseleave', () => { hideTimer = setTimeout(close, 900); });
      toast.addEventListener('click', close);

      function close(){
        toast.classList.add('nx-toast--closing');
        toast.addEventListener('animationend', () => toast.remove(), {once:true});
      }
    }

    document.addEventListener('click', function(e){
      const btn = e.target.closest('.nx-btn--ghost');
      if(!btn) return;
      e.preventDefault();
      showToast('This button is locked');
    }, {passive:false});
  })();

  updateExchangeRate();
</script>
<script src="/js/settings.js"></script>
</html>
